#!/bin/bash
# /usr/local/bin/bayan_installer

INSTALL_SCRIPTS_DIR="/usr/local/scripts"


# Find drive to install 

OUTPUT_FILE=$(mktemp /tmp/selected_drive.XXXXXX)
go run "${INSTALL_SCRIPTS_DIR}/select_disk.go" --output="$OUTPUT_FILE"

EXIT_STATUS=$?
if [ "$EXIT_STATUS" -ne 0 ]; then
  echo "Failed"
  exit 1
fi

{
  read -r diskName
  read -r diskSize
} < $OUTPUT_FILE

DRIVES="$(go run "${INSTALL_SCRIPTS_DIR}/partition_disk.go" \
  --diskName="$diskName" --diskSize="$diskSize")"

EXIT_STATUS=$?
if [ "$EXIT_STATUS" -ne 0 ]; then
  echo "Failed"
  exit 1
fi

{
  read -r efiName
  read -r swapName
  read -r rootName
} <<< "$DRIVES"

